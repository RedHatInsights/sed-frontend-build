"use strict";(self.webpackChunksed_frontend=self.webpackChunksed_frontend||[]).push([[362],{96132:(e,t,n)=>{n.r(t),n.d(t,{default:()=>re});var a=n(87757),r=n.n(a),o=n(48926),l=n.n(o),s=n(63038),c=n.n(s),i=n(76430),u=n(50470),d=n(83215),m=n(80123),p=n(39173),f=n(97522),b=n.n(f),g=n(43476),h=n(16530),y=n(4147),E=n(45697),v=n.n(E),C=n(94962),O=n(1401),S=function(e){var t=e.isOpen,n=void 0!==t&&t,a=e.handleCancel,o=e.handleConfirm,s=e.systemsCount,c=e.data;return b().createElement(i.Modal,{variant:"small",title:"Confirm changes",isOpen:n,onClose:a,actions:[b().createElement(i.Button,{key:"confirm",variant:"primary",type:"button",onClick:o},"Confirm changes"),b().createElement(i.Button,{key:"cancel",variant:"link",type:"button",onClick:a},"Cancel")]},b().createElement(i.TextContent,null,b().createElement(i.Text,{component:"p"},"Your changes applies to"," ",b().createElement("b",null,s," connected ",(0,O._)(s,"system")),". Selected settings will also be applied to ",b().createElement("b",null,"all future systems")," ","that are connected through remote host configuration (rhc)."),b().createElement(i.Text,{component:"p",className:"pf-u-mb-sm"},"Upon confirmation, an Ansible Playbook will be pushed to"," ",s," ",(0,O._)(s,"system")," to apply changes.")),b().createElement(i.Button,{variant:"link",onClick:function(){l()(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.dx.getPlaybookPreview({compliance_openscap:c.useOpenSCAP?"enabled":"disabled",insights:c.hasInsights?"enabled":"disabled",remediations:c.enableCloudConnector?"enabled":"disabled"});case 2:t=e.sent,(0,O.S)(t);case 4:case"end":return e.stop()}}),e)})))()},style:{paddingLeft:0}},"View playbook"))};S.propTypes={isOpen:v().bool,handleConfirm:v().func.isRequired,handleCancel:v().func.isRequired,systemsCount:v().number.isRequired,data:v().shape({useOpenSCAP:v().bool,enableCloudConnector:v().bool,hasInsights:v().bool})};const P=S;var _=n(59713),I=n.n(_),k=n(35451),j=n(80516),w=n(63529),R=n(43707),T=[{id:"useOpenSCAP",name:"Service: Use OpenSCAP for Compliance policies",additionalInfo:"Requires Insights",description:"This setting installs OpenSCAP for connected systems and ensures that systems are using the most current versions of profiles and policies. OpenSCAP is required for systems to use the compliance service.",links:[{name:"About Insights for RHEL Compliance",link:"https://access.redhat.com/documentation/en-us/red_hat_insights/2022/html/assessing_and_monitoring_security_policy_compliance_of_rhel_systems/index"},{name:"View configuration playbook",link:"https://github.com/RedHatInsights/config-manager/tree/master/playbooks"}]},{id:"enableCloudConnector",name:"Allow Insights users to use “Remediations” to send Ansible Playbooks to fix issues on your systems",description:"Users can create Ansible Playbooks using the “Remediate” function in Insights and then execute these playbooks on systems in inventory. Playbooks are sent to systems to fix issues using the Cloud Connector technology.",links:[{name:"About Cloud Connector",link:"https://access.redhat.com/documentation/en-us/red_hat_insights/2022/html-single/red_hat_connector_configuration_guide/index"}]}];function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function(e,t,n){return b().createElement(i.Button,{ouiaId:"secondary-edit-button",onClick:function(){return n(!0)},variant:"secondary",isAriaDisabled:e||!t},"Change settings")},F=function(e){var t=e.defaults,n=e.setConfirmChangesOpen,a=e.onChange,r=e.isEditing,o=e.setIsEditing,l={enableCloudConnector:{value:t.enableCloudConnector,isDisabled:!1},useOpenSCAP:{value:t.useOpenSCAP,isDisabled:!1}},s=(0,f.useState)(l),d=c()(s,2),m=d[0],p=d[1],g=(0,f.useState)(!1),h=c()(g,2),y=h[0],E=h[1],v=(0,R.T)("",["config-manager:activation_keys:*","config-manager:state:read","config-manager:state:write","config-manager:state-changes:read","inventory:*:read","playbook-dispatcher:run:read"],!1,!0),C=v.hasAccess,O=v.isLoading;return(0,f.useEffect)((function(){E(m.useOpenSCAP.value!==t.useOpenSCAP||m.enableCloudConnector.value!=t.enableCloudConnector),a({useOpenSCAP:m.useOpenSCAP.value,enableCloudConnector:m.enableCloudConnector.value})}),[m]),b().createElement(i.Stack,{hasGutter:!0,className:"pf-u-p-md"},b().createElement(i.StackItem,null,b().createElement(i.Toolbar,{id:"toolbar-items"},b().createElement(i.ToolbarContent,null,!r&&b().createElement(i.ToolbarItem,null,C?x(O,C,o):b().createElement(i.Tooltip,{content:b().createElement("div",null,'To perform this action, you must be granted the "System Administrator" role by your Organization Administrator in your Setting\'s User Access area.')},x(O,C,o))),r&&b().createElement(b().Fragment,null,b().createElement(i.ToolbarItem,null,b().createElement(i.Button,{ouiaId:"primary-save-button",onClick:function(){return n(!0)},isDisabled:!y},"Save changes")),b().createElement(i.ToolbarItem,null,b().createElement(i.Button,{ouiaId:"secondary-cancel-button",onClick:function(){return p(l),void o(!1)},variant:"secondary"},"Cancel")),b().createElement(i.ToolbarItem,null,b().createElement(i.Alert,{variant:"info",isInline:!0,isPlain:!0,title:"Changes will affect all systems connected with Red Hat connector"})))))),b().createElement(i.StackItem,null,b().createElement(w.TableComposable,{"aria-label":"Settings table"},b().createElement(w.Thead,null,b().createElement(w.Tr,null,b().createElement(w.Th,null,"Permission"),b().createElement(w.Th,null,"Status"))),b().createElement(w.Tbody,null,T.map((function(e){return b().createElement(w.Tr,{key:e.name},b().createElement(w.Td,{dataLabel:"Permission",width:80,style:e.secondary&&{paddingLeft:70,fontSize:14}},b().createElement(i.Stack,null,b().createElement(i.StackItem,null,b().createElement(i.Flex,null,b().createElement(i.FlexItem,null,b().createElement("b",null,e.name)),e.additionalInfo&&b().createElement(i.FlexItem,{style:{color:"var(--pf-global--Color--100)"}},b().createElement("i",null,e.additionalInfo)))),b().createElement(i.StackItem,{style:{fontSize:14}},e.description),e.links&&b().createElement(i.StackItem,{className:"stack-item"},b().createElement(i.Flex,null,e.links.map((function(e){return b().createElement(i.FlexItem,{key:e.name},b().createElement("a",{href:e.link,target:"_blank",rel:"noopener noreferrer"},e.name,b().createElement(u.ZP,{className:"pf-u-ml-sm"})))})))))),!r&&b().createElement(w.Td,{dataLabel:"Status"},function(e){return m[e.id].value?b().createElement(i.Flex,{style:{color:"var(--pf-global--success-color--200)"}},b().createElement(i.FlexItem,{spacer:{default:"spacerXs"}},b().createElement(k.ZP,null)),b().createElement(i.FlexItem,{className:"status"},b().createElement("b",null,"Enabled"))):b().createElement(i.Flex,{style:{color:"var(--pf-global--default-color--300)"}},b().createElement(i.FlexItem,{spacer:{default:"spacerXs"}},b().createElement(j.ZP,null)),b().createElement(i.FlexItem,{className:"status"},b().createElement("b",null,"Disabled")))}(e)),r&&b().createElement(w.Td,{dataLabel:"Status"},b().createElement(i.ToggleGroup,{"aria-label":"Default with single selectable"},b().createElement(i.ToggleGroupItem,{text:"Enabled",isSelected:m[e.id].value,onChange:function(){return p(D(D({},m),{},I()({},e.id,D(D({},m[e.id]),{},{value:!0}))))},isDisabled:m[e.id].isDisabled}),b().createElement(i.ToggleGroupItem,{text:"Disabled",isSelected:!m[e.id].value,onChange:function(){return p(D(D({},m),{},I()({},e.id,D(D({},m[e.id]),{},{value:!1}))))},isDisabled:m[e.id].isDisabled}))))}))))))};F.propTypes={setMadeChanges:v().func.isRequired,defaults:v().shape({useOpenSCAP:v().bool,hasInsights:v().bool,enableCloudConnector:v().bool}),onChange:v().func.isRequired,madeChanges:v().bool,setConfirmChangesOpen:v().func.isRequired,isEditing:v().bool.isRequired,setIsEditing:v().func.isRequired},F.defaultProps={defaults:{useOpenSCAP:!1,hasInsights:!1,enableCloudConnector:!1}};const L=F;var N,G=n(30319),U=n(94778),q=n(18546),H=n(49120);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const z=(0,q.Gg)((N={},I()(N,"".concat(H.o9,"_PENDING"),(function(e){return Z(Z({},e),{},{loaded:!1})})),I()(N,"".concat(H.o9,"_FULFILLED"),(function(e,t){var n=t.payload;return Z(Z({},e),{},{loaded:!0,hosts:(null==n?void 0:n.results)||[],total:(null==n?void 0:n.count)||0,page:(null==n?void 0:n.page)||0,perPage:(null==n?void 0:n.per_page)||0})})),I()(N,"".concat(H.o9,"_ERROR"),(function(){return{error:!0}})),N),{loaded:!1,values:{}});var M;function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=function(e){return Q(Q({},e),{},{loaded:!1})},X=function(e,t){var n,a,r,o=t.payload;return Q(Q({},e),{},{loaded:!0,values:{useOpenSCAP:"enabled"===(null==o||null===(n=o.state)||void 0===n?void 0:n.compliance_openscap),enableCloudConnector:"enabled"===(null==o||null===(a=o.state)||void 0===a?void 0:a.remediations),hasInsights:"enabled"===(null==o||null===(r=o.state)||void 0===r?void 0:r.insights)}})};const Y=(0,q.Gg)((M={},I()(M,"".concat(H.If,"_PENDING"),V),I()(M,"".concat(H.K8,"_PENDING"),V),I()(M,"".concat(H.K8,"_FULFILLED"),X),I()(M,"".concat(H.If,"_FULFILLED"),X),I()(M,"".concat(H.K8,"_ERROR"),(function(){return{error:!0}})),M),{loaded:!1,values:{}});var $;function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ee=(0,q.Gg)(($={},I()($,"".concat(H.tj,"_PENDING"),(function(e){return W(W({},e),{},{loaded:!1})})),I()($,"".concat(H.tj,"_FULFILLED"),(function(e,t){var n=t.payload;return W(W({},e),{},{loaded:!0},n||{})})),I()($,"".concat(H.tj,"_ERROR"),(function(){return{error:!0}})),$),{loaded:!1,results:[]});var te=y._j,ne=(0,f.lazy)((function(){return Promise.all([n.e(410),n.e(767)]).then(n.bind(n,98356))})),ae=(0,f.lazy)((function(){return Promise.all([n.e(410),n.e(252),n.e(736),n.e(239)]).then(n.bind(n,34003))}));const re=function(){var e=(0,h.useHistory)(),t=(0,f.useContext)(G.gE).getRegistry,n=(0,f.useState)(!1),a=c()(n,2),o=a[0],s=a[1],y=(0,f.useState)(!1),E=c()(y,2),v=E[0],C=E[1],O=(0,f.useState)(!1),S=c()(O,2),_=S[0],I=S[1],k=(0,f.useRef)(),j=(0,g.useDispatch)(),w=(0,g.useSelector)((function(e){var t=e.activeStateReducer;return null==t?void 0:t.loaded})),R=(0,g.useSelector)((function(e){var t,n,a,r=e.activeStateReducer;return{useOpenSCAP:null==r||null===(t=r.values)||void 0===t?void 0:t.useOpenSCAP,enableCloudConnector:null==r||null===(n=r.values)||void 0===n?void 0:n.enableCloudConnector,hasInsights:null==r||null===(a=r.values)||void 0===a?void 0:a.hasInsights}}),g.shallowEqual),T=R.useOpenSCAP,A=R.enableCloudConnector,D=R.hasInsights,x=(0,g.useSelector)((function(e){var t=e.connectedSystemsReducer;return{systemsLoaded:null==t?void 0:t.loaded,systemsCount:null==t?void 0:t.total}}),g.shallowEqual).systemsCount;return(0,f.useEffect)((function(){t().register({activeStateReducer:Y,logReducer:ee,connectedSystemsReducer:z}),j((0,U.Qe)()),j((0,U.j$)())}),[t]),(0,f.useEffect)((function(){var e,t,n;null===(e=insights)||void 0===e||null===(t=e.chrome)||void 0===t||null===(n=t.appAction)||void 0===n||n.call(t,"cloud-connector-dashboard")}),[]),b().createElement(b().Fragment,null,b().createElement(h.Route,{exact:!0,path:te.logModal,render:function(){return b().createElement(f.Suspense,{fallback:b().createElement(i.Bullseye,null,b().createElement(i.Spinner,null))},b().createElement(ae,null))}}),b().createElement(m.Z,{className:"page-header"},b().createElement(i.Split,{hasGutter:!0,className:"page-title"},b().createElement(i.SplitItem,{isFilled:!0},b().createElement(i.Flex,null,b().createElement(i.FlexItem,{spacer:{default:"spacerSm"}},b().createElement(p.Z,{title:"Remote Host Configuration Manager"})),b().createElement(i.FlexItem,null,b().createElement(ne,null)))),b().createElement(i.SplitItem,null,b().createElement(i.Button,{onClick:function(){return e.push(te.logModal)},variant:"link"},"View log"))),b().createElement(i.Stack,{hasGutter:!0},b().createElement(i.StackItem,null,"Selections here affect Red Hat Enterprise Linux (RHEL) systems connected to Red Hat with remote host configuration (rhc). Upon saving changes, Ansible Playbooks are automatically pushed to connected systems to update the configuration of the connection to Red Hat."),b().createElement(i.StackItem,null,b().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2022/html-single/red_hat_connector_configuration_guide/index"},"Connecting with Red Hat",b().createElement(u.ZP,{className:"pf-u-ml-sm"}))))),b().createElement(i.Page,null,b().createElement("div",{className:"dashboard__content"},w||void 0!==T&&void 0!==A?b().createElement(L,{madeChanges:v,setConfirmChangesOpen:s,setMadeChanges:C,setIsEditing:I,isEditing:_,defaults:{useOpenSCAP:T,enableCloudConnector:A,hasInsights:D},onChange:function(e){k.current=e}}):b().createElement(i.Bullseye,null,b().createElement(i.Spinner,{className:"pf-u-p-lg",size:"xl"})))),b().createElement(P,{isOpen:o,handleCancel:function(){return s(!1)},systemsCount:x,data:k.current,handleConfirm:function(){s(!1),l()(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,U.mt)(k.current),j(t),e.next=4,t.payload;case 4:j((0,d.wN)({variant:"success",title:"Changes saved",description:"Your service enablement changes were applied to connected systems"})),C(!1),I(!1);case 7:case"end":return e.stop()}}),e)})))()}}))}},94962:(e,t,n)=>{n.d(t,{dx:()=>l,TQ:()=>o,ok:()=>s});var a=n(77460),r=n(91571),o=function(){return a.ZP.get("".concat("/api/inventory/v1","/hosts?filter[system_profile][rhc_client_id]=not_nil&fields[system_profile]=rhc_client_id,rhc_config_state&staleness=fresh&staleness=stale&&registered_with=insights"))},l=new r.DefaultApi(void 0,"/api/config-manager/v1",a.ZP),s=function(e){var t=e.useOpenSCAP,n=e.enableCloudConnector,a=e.hasInsights;return l.updateStates({compliance_openscap:t?"enabled":"disabled",insights:t||n||a?"enabled":"disabled",remediations:n?"enabled":"disabled"})}},49120:(e,t,n)=>{n.d(t,{K8:()=>a,If:()=>r,tj:()=>o,o9:()=>l});var a="GET_CURR_STATE",r="SET_CURR_STATE",o="GET_LOG",l="GET_CONNECTED_HOSTS"},94778:(e,t,n)=>{n.d(t,{Qe:()=>o,mt:()=>l,VU:()=>s,j$:()=>c});var a=n(94962),r=n(49120),o=function(){return{type:r.K8,payload:a.dx.getCurrentState()}},l=function(e){return{type:r.If,payload:(0,a.ok)(e)}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.perPage,n=void 0===t?50:t,o=e.page,l=void 0===o?1:o;return{type:r.tj,payload:a.dx.getStates(n,(l-1)*n)}},c=function(){return{type:r.o9,payload:(0,a.TQ)()}}},1401:(e,t,n)=>{n.d(t,{_:()=>a,S:()=>r});var a=function(e,t,n){return e>1?n||t+"s":t},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"".concat((new Date).toISOString()),n="data:text/plain;charset=utf-8,",a=new Blob([e],{type:n}),r=document.createElement("a");r.setAttribute("href",URL.createObjectURL(a)),r.setAttribute("download","".concat(t,".yml")),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}}]);