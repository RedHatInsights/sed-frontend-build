"use strict";(self.webpackChunksed_frontend=self.webpackChunksed_frontend||[]).push([[600],{90600:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var r=n(63038),a=n.n(r),o=n(97522),i=n.n(o),l=n(16530),s=n(76430),c=n(14748),u=n(80123),m=n(39173),p=n(63529),d=n(87757),h=n.n(d),v=n(48926),y=n.n(v),f=n(88767),E=function(){var e=y()(h().mark((function e(){var t,n,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getToken();case 2:return t=e.sent,e.next=5,fetch("/api/rhsm/v2/activation_keys",{headers:{Authorization:"Bearer ".concat(t)}});case 5:return n=e.sent,e.next=8,n.json();case 8:return r=e.sent,e.abrupt("return",r.body);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=y()(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=n(28455),T=n(15984);const S=function(){var e="Key Name",t="Role",n="Usage",r=(0,f.useQuery)("activation_keys",(function(){return b()})),a=r.isLoading,o=r.error,l=r.data,s=function(){return i().createElement(p.TableComposable,{"aria-label":"ActivationKeys"},i().createElement(p.Thead,null,i().createElement(p.Tr,{ouiaSafe:!0},i().createElement(p.Th,null,e),i().createElement(p.Th,null,t),i().createElement(p.Th,null,"SLA"),i().createElement(p.Th,null,n))),i().createElement(p.Tbody,null,l.map((function(r){return i().createElement(p.Tr,{key:r.name,ouiaSafe:!0},i().createElement(p.Td,{dataLabel:e},r.name),i().createElement(p.Td,{dataLabel:t},r.role),i().createElement(p.Td,{dataLabel:"SLA"},r.serviceLevel),i().createElement(p.Td,{dataLabel:n},r.usage))}))))};return a&&!o?i().createElement(g.Z,null):a||o?i().createElement(T.Z,null):i().createElement(s,null)};var x=n(75663);const k=function(){return i().createElement(s.Bullseye,null,i().createElement(s.EmptyState,null,i().createElement(s.EmptyStateIcon,{icon:x.ZP}),i().createElement(s.Title,{headingLevel:"h4",size:"lg"},"Activation keys can only be accessed by organization administrators."),i().createElement(s.EmptyStateBody,null,"If you already know your organization ID and activation key, you can register systems with RHC.")))};var w=n(34046),C=function(){var e=y()(h().mark((function e(){var t,n,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getToken();case 2:return t=e.sent,e.next=5,fetch("/api/rhsm/v2/organization?include=system_purpose_attributes",{headers:{Authorization:"Bearer ".concat(t)}});case 5:return n=e.sent,e.next=8,n.json();case 8:return r=e.sent,e.abrupt("return",r.body);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=y()(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return t=e.sent,e.abrupt("return",t.systemPurposeAttributes);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=n(45697),R=n.n(L),z=function(e){var t=e.label,n=e.popover,r=e.data,l=e.onSelect,c=e.helperText,u=(0,o.useState)(!1),m=a()(u,2),p=m[0],d=m[1],h=(0,o.useState)(""),v=a()(h,2),y=v[0],f=v[1],E=r.map((function(e){return i().createElement(s.SelectOption,{key:e,value:e,label:e})}));return i().createElement(s.FormGroup,{label:t,labelIcon:n,helperText:c},i().createElement(s.Select,{variant:s.SelectVariant.single,placeholderText:"Select an option",isOpen:p,onSelect:function(e,t){f(t),d(!p),l(t)},onToggle:function(){d(!p)},selections:y},E))};z.propTypes={label:R().string.isRequired,popover:R().element.isRequired,helperText:R().string,data:R().array.isRequired,onSelect:R().func.isRequired};const q=z;var P=n(43476),O=n(83215),V=function(e){var t=e.handleModalToggle,n=e.submitForm,r=e.isSuccess,l=e.isError,c=(0,P.useDispatch)(),u=(0,f.useQuery)("organization_system_puprose_attributes",(function(){return A()})),m=u.isLoading,p=u.error,d=u.data,h=(0,o.useState)(""),v=a()(h,2),y=v[0],E=v[1],b=(0,o.useState)(""),g=a()(b,2),T=g[0],S=g[1],x=(0,o.useState)(""),k=a()(x,2),C=k[0],L=k[1],R=(0,o.useState)(""),z=a()(R,2),V=z[0],_=z[1],M=(0,o.useState)("default"),Z=a()(M,2),B=Z[0],D=Z[1],F="^[a-z][a-z0-9-]*$";return r?(c((0,O.wN)({variant:"success",title:" Activation Key was created successfully",description:"",dismissable:!0})),t()):l&&(c((0,O.wN)({variant:"danger",title:"An Error Occurred",description:"Activation Key was not created, please try again",dismissable:!0,autoDismiss:!1})),t()),i().createElement(s.Form,{id:"create-activation-key-form",onSubmit:function(e){e.preventDefault(),"success"===B?n(y,T,C,V):D("error")}},i().createElement(s.FormGroup,{label:"Name",isRequired:!0,helperText:"Enter the name of the activation key. Must start with a letter and end with a letter or number. Valid characters include lowercase letters from a to z, numbers from 0 to 9, and hyphens ( - )."},i().createElement(s.TextInput,{id:"activation-key-name",label:"Name",isRequired:!0,type:"text",validated:B,onChange:function(e){0===e.length?D("error"):e.match(F)?(D("success"),E(e)):D("error")}})),!m&&!p&&i().createElement(q,{data:d.roles,onSelect:S,label:"Role",popover:i().createElement(s.Popover,{bodyContent:i().createElement(s.TextContent,null,i().createElement(s.Text,{component:s.TextVariants.p},"Role is used to categorize systems by the workload on the system"),i().createElement(s.Text,{component:s.TextVariants.p},"Subscription Watch can help you filter and report by these items."),i().createElement(s.Text,{component:s.TextVariants.p},"Only roles available to your account are shown."))},i().createElement(w.ZP,null)),helperText:"Select the required role from the list. The list only contains roles available to the activation key."}),!m&&!p&&i().createElement(q,{data:d.serviceLevel,onSelect:L,label:"Service Level Agreement (SLA)",popover:i().createElement(s.Popover,{bodyContent:i().createElement(s.TextContent,null,i().createElement(s.Text,{component:s.TextVariants.p},"Service Level Agreement (SLA) determines the level of support for systems registered with this activation key."))},i().createElement(w.ZP,null)),helperText:"Select the required service level from the list. The list only contains service levels available to the activation key."}),!m&&!p&&i().createElement(q,{data:d.usage,onSelect:_,label:"Usage",popover:i().createElement(s.Popover,{bodyContent:i().createElement(s.TextContent,null,i().createElement(s.Text,{component:s.TextVariants.p},"Usage is used to categorize systems by how they are meant to be used, and therefore supported."),i().createElement(s.Text,{component:s.TextVariants.p},"Subscription Watch can help you filter and report by these items."))},i().createElement(w.ZP,null)),helperText:"Select the required usage from the list. The list only contains usages available to the activation key."}),i().createElement(s.ActionGroup,null,i().createElement(s.Button,{key:"create",id:"create-activation-key-button",variant:"primary",type:"submit",isDisabled:"error"===B||0===y.length||!y.match(F)},"Save"),i().createElement(s.Button,{key:"cancel",id:"cancel-create-activation-key-button",variant:"link",onClick:t},"Cancel")))};V.propTypes={handleModalToggle:R().func.isRequired,submitForm:R().func.isRequired,isSuccess:R().bool,isError:R().bool};const _=V;var M=function(){var e=y()(h().mark((function e(t){var n,r,a,o,i,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.role,a=t.serviceLevel,o=t.usage,e.next=3,window.insights.chrome.auth.getToken();case 3:return i=e.sent,e.next=6,fetch("/api/rhsm/v2/activation_keys",{method:"POST",headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"},body:JSON.stringify({name:n,role:r,serviceLevel:a,usage:o})});case 6:if((l=e.sent).ok){e.next=9;break}throw new Error("Status Code ".concat(l.status,".  Error creating activation key: ").concat(l.statusText,"."));case 9:return e.abrupt("return",l.json());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(e){var t,n=e.handleModalToggle,r=e.isOpen,a=(t=(0,f.useQueryClient)(),(0,f.useMutation)(M,{onSuccess:function(){t.resetQueries("activation_keys")}})),i=a.mutate,l=a.isSuccess,c=a.isError,u=a.isLoading;return o.createElement(s.Modal,{variant:s.ModalVariant.large,title:"Create new activation key",description:"",isOpen:r,onClose:n},u?o.createElement(g.Z,null):o.createElement(_,{handleModalToggle:n,submitForm:function(e,t,n,r){i({name:e,role:t,serviceLevel:n,usage:r})},isSuccess:l,isError:c}))};Z.propTypes={handleModalToggle:R().func.isRequired,isOpen:R().bool.isRequired};const B=Z,D=(0,l.withRouter)((function(){var e=(0,f.useQueryClient)().getQueryData("user"),t=(0,o.useState)(!1),n=a()(t,2),r=n[0],l=n[1],p=function(){l(!r)},d=function(){return i().createElement(i().Fragment,null,i().createElement(u.Z,null,i().createElement(m.Z,{title:"Activation Keys"}),i().createElement(s.TextContent,null,i().createElement(s.Text,{component:s.TextVariants.p},"Organization ID: ",e.orgId))),i().createElement(c.Z,null,i().createElement(s.PageSection,{variant:s.PageSectionVariants.light},i().createElement(s.ActionGroup,null,i().createElement(s.Button,{variant:"primary",onClick:p},"Create activation key")),i().createElement(S,null))),i().createElement(B,{isOpen:r,handleModalToggle:p}))};return e.rbacPermissions.canReadActivationKeys?i().createElement(d,null):i().createElement(k,null)}))}}]);
//# sourceMappingURL=../sourcemaps/600.234e64cd3aa509782c62574b520508ad.js.map