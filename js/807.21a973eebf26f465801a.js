"use strict";(self.webpackChunksed_frontend=self.webpackChunksed_frontend||[]).push([[807],{73807:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var a=n(63038),r=n.n(a),o=n(97522),l=n.n(o),i=n(16530),c=n(76430),s=n(14748),u=n(80123),m=n(39173),p=n(63529),d=n(87757),h=n.n(d),v=n(48926),y=n.n(v),E=n(88767),f=function(){var e=y()(h().mark((function e(){var t,n,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getToken();case 2:return t=e.sent,e.next=5,fetch("/api/rhsm/v2/activation_keys",{headers:{Authorization:"Bearer ".concat(t)}});case 5:return n=e.sent,e.next=8,n.json();case 8:return a=e.sent,e.abrupt("return",a.body);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=y()(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){return(0,E.useQuery)("activation_keys",(function(){return g()}))},T=n(28455),S=n(15984);const k=function(){var e="Key Name",t="Role",n="Usage",a=b(),r=a.isLoading,o=a.error,i=a.data,c=function(){return l().createElement(p.TableComposable,{"aria-label":"ActivationKeys"},l().createElement(p.Thead,null,l().createElement(p.Tr,{ouiaSafe:!0},l().createElement(p.Th,null,e),l().createElement(p.Th,null,t),l().createElement(p.Th,null,"SLA"),l().createElement(p.Th,null,n))),l().createElement(p.Tbody,null,i.map((function(a){return l().createElement(p.Tr,{key:a.name,ouiaSafe:!0},l().createElement(p.Td,{dataLabel:e},a.name),l().createElement(p.Td,{dataLabel:t},a.role),l().createElement(p.Td,{dataLabel:"SLA"},a.serviceLevel),l().createElement(p.Td,{dataLabel:n},a.usage))}))))};return r&&!o?l().createElement(T.Z,null):r||o?l().createElement(S.Z,null):l().createElement(c,null)};var x=n(75663);const w=function(){return l().createElement(c.Bullseye,null,l().createElement(c.EmptyState,null,l().createElement(c.EmptyStateIcon,{icon:x.ZP}),l().createElement(c.Title,{headingLevel:"h4",size:"lg"},"Activation keys can only be accessed by organization administrators."),l().createElement(c.EmptyStateBody,null,"If you already know your organization ID and activation key, you can register systems with RHC.")))};var C=n(45697),L=n.n(C),A=n(25811),R=function(e){var t=e.onClick,n=(0,E.useQueryClient)().getQueryData("user");return l().createElement(c.Button,{variant:"primary",onClick:t,isDisabled:!n.rbacPermissions.canWriteActivationKeys},"Create activation key")};R.propTypes={onClick:L().func.isRequired};const q=R;var z=function(e){var t=e.handleModalToggle;return l().createElement(l().Fragment,null,l().createElement(c.EmptyState,null,l().createElement(c.EmptyStateIcon,{icon:A.ZP}),l().createElement(c.Title,{headingLevel:"h5",size:"lg"},"No activation keys"),l().createElement(c.EmptyStateBody,null,"You currently have no activation keys to display. Activation keys allow you to register a system with system purpose, role and usage attached."),l().createElement(q,{onClick:t})))};z.propTypes={handleModalToggle:L().func.isRequired};const P=z;var V=n(34046),M=function(){var e=y()(h().mark((function e(){var t,n,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getToken();case 2:return t=e.sent,e.next=5,fetch("/api/rhsm/v2/organization?include=system_purpose_attributes",{headers:{Authorization:"Bearer ".concat(t)}});case 5:return n=e.sent,e.next=8,n.json();case 8:return a=e.sent,e.abrupt("return",a.body);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=y()(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:return t=e.sent,e.abrupt("return",t.systemPurposeAttributes);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(e){var t=e.label,n=e.popover,a=e.data,i=e.onSelect,s=e.helperText,u=e.name,m=e.placeholderValue,p=(0,o.useState)(""),d=r()(p,2),h=d[0],v=d[1],y=a.map((function(e){return l().createElement(c.FormSelectOption,{key:e,value:e,label:e})}));return l().createElement(c.FormGroup,{label:t,labelIcon:n,helperText:s},l().createElement(c.FormSelect,{onChange:function(e){v(e),i(e)},value:h,name:u,"aria-label":m},l().createElement(c.FormSelectOption,{label:m,isPlaceholder:!0}),y))};F.propTypes={label:L().string.isRequired,popover:L().element.isRequired,helperText:L().string,data:L().array.isRequired,onSelect:L().func.isRequired,name:L().string,placeholderValue:L().string};const _=F;var O=n(55091),B=function(e){var t=e.handleModalToggle,n=e.submitForm,a=e.isSuccess,i=e.isError,s=(0,O.Z)(),u=s.addSuccessNotification,m=s.addErrorNotification,p=(0,E.useQuery)("organization_system_puprose_attributes",(function(){return Z()})),d=p.isLoading,h=p.error,v=p.data,y=(0,o.useState)(""),f=r()(y,2),g=f[0],b=f[1],T=(0,o.useState)(""),S=r()(T,2),k=S[0],x=S[1],w=(0,o.useState)(""),C=r()(w,2),L=C[0],A=C[1],R=(0,o.useState)(""),q=r()(R,2),z=q[0],P=q[1],M=(0,o.useState)("default"),F=r()(M,2),B=F[0],I=F[1],Q="^[a-z][a-z0-9-]*$";return a?(u("Activation Key was created successfully",{timeout:!1}),t()):i&&(m("Activation Key was not created, please try again",{timeout:8e3}),t()),l().createElement(c.Form,{id:"create-activation-key-form",onSubmit:function(e){e.preventDefault(),"success"===B?n(g,k,L,z):I("error")}},l().createElement(c.FormGroup,{label:"Name",isRequired:!0,helperText:"Enter the name of the activation key. Must start with a letter and end with a letter or number. Valid characters include lowercase letters from a to z, numbers from 0 to 9, and hyphens ( - )."},l().createElement(c.TextInput,{id:"activation-key-name",label:"Name",isRequired:!0,type:"text",validated:B,onChange:function(e){0===e.length?I("error"):e.match(Q)?(I("success"),b(e)):I("error")},name:"name"})),!d&&!h&&l().createElement(_,{data:v.roles,onSelect:x,label:"Role",name:"role",placeholderValue:"Select role",popover:l().createElement(c.Popover,{bodyContent:l().createElement(c.TextContent,null,l().createElement(c.Text,{component:c.TextVariants.p},"Role is used to categorize systems by the workload on the system"),l().createElement(c.Text,{component:c.TextVariants.p},"Subscription Watch can help you filter and report by these items."),l().createElement(c.Text,{component:c.TextVariants.p},"Only roles available to your account are shown."))},l().createElement(V.ZP,null)),helperText:"Select the required role from the list. The list only contains roles available to the activation key."}),!d&&!h&&l().createElement(_,{data:v.serviceLevel,onSelect:A,label:"Service Level Agreement (SLA)",name:"serviceLevel",placeholderValue:"Select a service level agreement",popover:l().createElement(c.Popover,{bodyContent:l().createElement(c.TextContent,null,l().createElement(c.Text,{component:c.TextVariants.p},"Service Level Agreement (SLA) determines the level of support for systems registered with this activation key."))},l().createElement(V.ZP,null)),helperText:"Select the required service level from the list. The list only contains service levels available to the activation key."}),!d&&!h&&l().createElement(_,{data:v.usage,onSelect:P,label:"Usage",name:"usage",placeholderValue:"Select usage",popover:l().createElement(c.Popover,{bodyContent:l().createElement(c.TextContent,null,l().createElement(c.Text,{component:c.TextVariants.p},"Usage is used to categorize systems by how they are meant to be used, and therefore supported."),l().createElement(c.Text,{component:c.TextVariants.p},"Subscription Watch can help you filter and report by these items."))},l().createElement(V.ZP,null)),helperText:"Select the required usage from the list. The list only contains usages available to the activation key."}),l().createElement(c.ActionGroup,null,l().createElement(c.Button,{key:"create",id:"create-activation-key-button",variant:"primary",type:"submit",isDisabled:"error"===B||0===g.length||!g.match(Q)},"Save"),l().createElement(c.Button,{key:"cancel",id:"cancel-create-activation-key-button",variant:"link",onClick:t},"Cancel")))};B.propTypes={handleModalToggle:L().func.isRequired,submitForm:L().func.isRequired,isSuccess:L().bool,isError:L().bool};const I=B;var Q=function(){var e=y()(h().mark((function e(t){var n,a,r,o,l,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=t.role,r=t.serviceLevel,o=t.usage,e.next=3,window.insights.chrome.auth.getToken();case 3:return l=e.sent,e.next=6,fetch("/api/rhsm/v2/activation_keys",{method:"POST",headers:{Authorization:"Bearer ".concat(l),"Content-Type":"application/json"},body:JSON.stringify({name:n,role:a,serviceLevel:r,usage:o})});case 6:if((i=e.sent).ok){e.next=9;break}throw new Error("Status Code ".concat(i.status,".  Error creating activation key: ").concat(i.statusText,"."));case 9:return e.abrupt("return",i.json());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(e){var t=(0,E.useQueryClient)(),n=o.useState(!1),a=r()(n,2),l=a[0],i=a[1],s=o.useState(!1),u=r()(s,2),m=u[0],p=u[1],d=e.handleModalToggle,h=e.isOpen,v=(0,E.useMutation)(Q),y=v.mutate,f=v.isLoading;return o.createElement(c.Modal,{variant:c.ModalVariant.large,title:"Create new activation key",description:"",isOpen:h,onClose:d},f?o.createElement(T.Z,null):o.createElement(I,{handleModalToggle:d,submitForm:function(e,n,a,r){y({name:e,role:n,serviceLevel:a,usage:r},{onSuccess:function(){p(!1),i(!0),t.invalidateQueries("activation_keys")},onError:function(){p(!0),i(!1)}})},isSuccess:l,isError:m}))};D.propTypes={handleModalToggle:L().func.isRequired,isOpen:L().bool.isRequired};const K=D,N=(0,i.withRouter)((function(){var e,t=(0,E.useQueryClient)().getQueryData("user"),n=b(),a=n.isLoading,i=n.error,p=n.data,d=(0,o.useState)(!1),h=r()(d,2),v=h[0],y=h[1],f=function(){y(!v)};a?e=l().createElement(T.Z,null):a||i||p.length?a||i||!p.length||(e=l().createElement(l().Fragment,null,l().createElement(c.ActionGroup,null,l().createElement(q,{onClick:f})),l().createElement(k,null))):e=l().createElement(P,{handleModalToggle:f});var g=function(){return l().createElement(l().Fragment,null,l().createElement(u.Z,null,l().createElement(m.Z,{title:"Activation Keys"}),l().createElement(c.TextContent,null,l().createElement(c.Text,{component:c.TextVariants.p},"Organization ID: ",t.orgId))),l().createElement(s.Z,null,l().createElement(c.PageSection,{variant:c.PageSectionVariants.light},e)),l().createElement(K,{isOpen:v,handleModalToggle:f}))};return t.rbacPermissions.canReadActivationKeys?l().createElement(g,null):l().createElement(w,null)}))}}]);
//# sourceMappingURL=../sourcemaps/807.268c3606b11cfafa32e7c72cf4589ca1.js.map