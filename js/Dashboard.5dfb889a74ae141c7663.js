"use strict";(self.webpackChunksed_frontend=self.webpackChunksed_frontend||[]).push([[362],{96132:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ne});var a=n(87757),r=n.n(a),l=n(48926),o=n.n(l),s=n(63038),c=n.n(s),i=n(76430),u=n(50470),d=n(83215),m=n(80123),p=n(39173),f=n(97522),b=n.n(f),h=n(43476),g=n(16530),y=n(4147),E=n(45697),v=n.n(E),C=n(94962),O=n(1401),S=function(e){var t=e.isOpen,n=void 0!==t&&t,a=e.handleCancel,l=e.handleConfirm,s=e.systemsCount,c=e.data;return b().createElement(i.Modal,{variant:"small",title:"Confirm changes",isOpen:n,onClose:a,actions:[b().createElement(i.Button,{key:"confirm",variant:"primary",type:"button",onClick:l},"Confirm changes"),b().createElement(i.Button,{key:"cancel",variant:"link",type:"button",onClick:a},"Cancel")]},b().createElement(i.TextContent,null,b().createElement(i.Text,{component:"p"},"Your changes applies to"," ",b().createElement("b",null,s," connected ",(0,O._)(s,"system")),". Selected settings will also be applied to ",b().createElement("b",null,"all future systems")," ","that are connected through remote host configuration (rhc)."),b().createElement(i.Text,{component:"p",className:"pf-u-mb-sm"},"Upon confirmation, an Ansible Playbook will be pushed to"," ",s," ",(0,O._)(s,"system")," to apply changes.")),b().createElement(i.Button,{variant:"link",onClick:function(){o()(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.dx.getPlaybookPreview({compliance_openscap:c.useOpenSCAP?"enabled":"disabled",insights:c.hasInsights?"enabled":"disabled",remediations:c.enableCloudConnector?"enabled":"disabled"});case 2:t=e.sent,(0,O.S)(t);case 4:case"end":return e.stop()}}),e)})))()},style:{paddingLeft:0}},"View playbook"))};S.propTypes={isOpen:v().bool,handleConfirm:v().func.isRequired,handleCancel:v().func.isRequired,systemsCount:v().number.isRequired,data:v().shape({useOpenSCAP:v().bool,enableCloudConnector:v().bool,hasInsights:v().bool})};const P=S;var _=n(59713),I=n.n(_),k=n(35451),j=n(80516),w=n(63529),R=[{id:"useOpenSCAP",name:"Service: Use OpenSCAP for Compliance policies",additionalInfo:"Requires Insights",description:"This setting installs OpenSCAP for connected systems and ensures that systems are using the most current versions of profiles and policies. OpenSCAP is required for systems to use the compliance service.",links:[{name:"About Insights for RHEL Compliance",link:"https://access.redhat.com/documentation/en-us/red_hat_insights/2021/html/assessing_and_monitoring_security_policy_compliance_of_rhel_systems/index"},{name:"View configuration playbook",link:"https://github.com/RedHatInsights/config-manager/tree/master/playbooks"}]},{id:"enableCloudConnector",name:"Allow Insights users to use “Remediations” to send Ansible Playbooks to fix issues on your systems",description:"Users can create Ansible Playbooks using the “Remediate” function in Insights and then execute these playbooks on systems in inventory. Playbooks are sent to systems to fix issues using the Cloud Connector technology.",links:[{name:"About Cloud Connector",link:"https://access.redhat.com/documentation/en-us/red_hat_insights/2021/html-single/red_hat_connector_configuration_guide/index"}]}];function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){var t=e.defaults,n=e.setConfirmChangesOpen,a=e.onChange,r=e.isEditing,l=e.setIsEditing,o={enableCloudConnector:{value:t.enableCloudConnector,isDisabled:!1},useOpenSCAP:{value:t.useOpenSCAP,isDisabled:!1}},s=(0,f.useState)(o),d=c()(s,2),m=d[0],p=d[1],h=(0,f.useState)(!1),g=c()(h,2),y=g[0],E=g[1];return(0,f.useEffect)((function(){E(m.useOpenSCAP.value!==t.useOpenSCAP||m.enableCloudConnector.value!=t.enableCloudConnector),a({useOpenSCAP:m.useOpenSCAP.value,enableCloudConnector:m.enableCloudConnector.value})}),[m]),b().createElement(i.Stack,{hasGutter:!0,className:"pf-u-p-md"},b().createElement(i.StackItem,null,b().createElement(i.Toolbar,{id:"toolbar-items"},b().createElement(i.ToolbarContent,null,!r&&b().createElement(i.ToolbarItem,null,b().createElement(i.Button,{ouiaId:"secondary-edit-button",onClick:function(){return l(!0)},variant:"secondary"},"Change settings")),r&&b().createElement(b().Fragment,null,b().createElement(i.ToolbarItem,null,b().createElement(i.Button,{ouiaId:"primary-save-button",onClick:function(){return n(!0)},isDisabled:!y},"Save changes")),b().createElement(i.ToolbarItem,null,b().createElement(i.Button,{ouiaId:"secondary-cancel-button",onClick:function(){return p(o),void l(!1)},variant:"secondary"},"Cancel")),b().createElement(i.ToolbarItem,null,b().createElement(i.Alert,{variant:"info",isInline:!0,isPlain:!0,title:"Changes will affect all systems connected with Red Hat connector"})))))),b().createElement(i.StackItem,null,b().createElement(w.TableComposable,{"aria-label":"Settings table"},b().createElement(w.Thead,null,b().createElement(w.Tr,null,b().createElement(w.Th,null,"Permission"),b().createElement(w.Th,null,"Status"))),b().createElement(w.Tbody,null,R.map((function(e){return b().createElement(w.Tr,{key:e.name},b().createElement(w.Td,{dataLabel:"Permission",width:80,style:e.secondary&&{paddingLeft:70,fontSize:14}},b().createElement(i.Stack,null,b().createElement(i.StackItem,null,b().createElement(i.Flex,null,b().createElement(i.FlexItem,null,b().createElement("b",null,e.name)),e.additionalInfo&&b().createElement(i.FlexItem,{style:{color:"var(--pf-global--Color--100)"}},b().createElement("i",null,e.additionalInfo)))),b().createElement(i.StackItem,{style:{fontSize:14}},e.description),e.links&&b().createElement(i.StackItem,{className:"stack-item"},b().createElement(i.Flex,null,e.links.map((function(e){return b().createElement(i.FlexItem,{key:e.name},b().createElement("a",{href:e.link,target:"_blank",rel:"noopener noreferrer"},e.name,b().createElement(u.ZP,{className:"pf-u-ml-sm"})))})))))),!r&&b().createElement(w.Td,{dataLabel:"Status"},function(e){return m[e.id].value?b().createElement(i.Flex,{style:{color:"var(--pf-global--success-color--200)"}},b().createElement(i.FlexItem,{spacer:{default:"spacerXs"}},b().createElement(k.ZP,null)),b().createElement(i.FlexItem,{className:"status"},b().createElement("b",null,"Enabled"))):b().createElement(i.Flex,{style:{color:"var(--pf-global--default-color--300)"}},b().createElement(i.FlexItem,{spacer:{default:"spacerXs"}},b().createElement(j.ZP,null)),b().createElement(i.FlexItem,{className:"status"},b().createElement("b",null,"Disabled")))}(e)),r&&b().createElement(w.Td,{dataLabel:"Status"},b().createElement(i.ToggleGroup,{"aria-label":"Default with single selectable"},b().createElement(i.ToggleGroupItem,{text:"Enabled",isSelected:m[e.id].value,onChange:function(){return p(D(D({},m),{},I()({},e.id,D(D({},m[e.id]),{},{value:!0}))))},isDisabled:m[e.id].isDisabled}),b().createElement(i.ToggleGroupItem,{text:"Disabled",isSelected:!m[e.id].value,onChange:function(){return p(D(D({},m),{},I()({},e.id,D(D({},m[e.id]),{},{value:!1}))))},isDisabled:m[e.id].isDisabled}))))}))))))};T.propTypes={setMadeChanges:v().func.isRequired,defaults:v().shape({useOpenSCAP:v().bool,hasInsights:v().bool,enableCloudConnector:v().bool}),onChange:v().func.isRequired,madeChanges:v().bool,setConfirmChangesOpen:v().func.isRequired,isEditing:v().bool.isRequired,setIsEditing:v().func.isRequired},T.defaultProps={defaults:{useOpenSCAP:!1,hasInsights:!1,enableCloudConnector:!1}};const A=T;var F,L=n(30319),N=n(94778),G=n(18546),U=n(49120);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const B=(0,G.Gg)((F={},I()(F,"".concat(U.o9,"_PENDING"),(function(e){return H(H({},e),{},{loaded:!1})})),I()(F,"".concat(U.o9,"_FULFILLED"),(function(e,t){var n=t.payload;return H(H({},e),{},{loaded:!0,hosts:(null==n?void 0:n.results)||[],total:(null==n?void 0:n.count)||0,page:(null==n?void 0:n.page)||0,perPage:(null==n?void 0:n.per_page)||0})})),I()(F,"".concat(U.o9,"_ERROR"),(function(){return{error:!0}})),F),{loaded:!1,values:{}});var Z;function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){return z(z({},e),{},{loaded:!1})},Q=function(e,t){var n,a,r,l=t.payload;return z(z({},e),{},{loaded:!0,values:{useOpenSCAP:"enabled"===(null==l||null===(n=l.state)||void 0===n?void 0:n.compliance_openscap),enableCloudConnector:"enabled"===(null==l||null===(a=l.state)||void 0===a?void 0:a.remediations),hasInsights:"enabled"===(null==l||null===(r=l.state)||void 0===r?void 0:r.insights)}})};const V=(0,G.Gg)((Z={},I()(Z,"".concat(U.If,"_PENDING"),K),I()(Z,"".concat(U.K8,"_PENDING"),K),I()(Z,"".concat(U.K8,"_FULFILLED"),Q),I()(Z,"".concat(U.If,"_FULFILLED"),Q),I()(Z,"".concat(U.K8,"_ERROR"),(function(){return{error:!0}})),Z),{loaded:!1,values:{}});var X;function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const J=(0,G.Gg)((X={},I()(X,"".concat(U.tj,"_PENDING"),(function(e){return $($({},e),{},{loaded:!1})})),I()(X,"".concat(U.tj,"_FULFILLED"),(function(e,t){var n=t.payload;return $($({},e),{},{loaded:!0},n||{})})),I()(X,"".concat(U.tj,"_ERROR"),(function(){return{error:!0}})),X),{loaded:!1,results:[]});var W=y._j,ee=(0,f.lazy)((function(){return Promise.all([n.e(410),n.e(767)]).then(n.bind(n,98356))})),te=(0,f.lazy)((function(){return Promise.all([n.e(410),n.e(252),n.e(736),n.e(239)]).then(n.bind(n,34003))}));const ne=function(){var e=(0,g.useHistory)(),t=(0,f.useContext)(L.gE).getRegistry,n=(0,f.useState)(!1),a=c()(n,2),l=a[0],s=a[1],y=(0,f.useState)(!1),E=c()(y,2),v=E[0],C=E[1],O=(0,f.useState)(!1),S=c()(O,2),_=S[0],I=S[1],k=(0,f.useRef)(),j=(0,h.useDispatch)(),w=(0,h.useSelector)((function(e){var t=e.activeStateReducer;return null==t?void 0:t.loaded})),R=(0,h.useSelector)((function(e){var t,n,a,r=e.activeStateReducer;return{useOpenSCAP:null==r||null===(t=r.values)||void 0===t?void 0:t.useOpenSCAP,enableCloudConnector:null==r||null===(n=r.values)||void 0===n?void 0:n.enableCloudConnector,hasInsights:null==r||null===(a=r.values)||void 0===a?void 0:a.hasInsights}}),h.shallowEqual),x=R.useOpenSCAP,D=R.enableCloudConnector,T=R.hasInsights,F=(0,h.useSelector)((function(e){var t=e.connectedSystemsReducer;return{systemsLoaded:null==t?void 0:t.loaded,systemsCount:null==t?void 0:t.total}}),h.shallowEqual).systemsCount;return(0,f.useEffect)((function(){t().register({activeStateReducer:V,logReducer:J,connectedSystemsReducer:B}),j((0,N.Qe)()),j((0,N.j$)())}),[t]),(0,f.useEffect)((function(){var e,t,n;null===(e=insights)||void 0===e||null===(t=e.chrome)||void 0===t||null===(n=t.appAction)||void 0===n||n.call(t,"cloud-connector-dashboard")}),[]),b().createElement(b().Fragment,null,b().createElement(g.Route,{exact:!0,path:W.logModal,render:function(){return b().createElement(f.Suspense,{fallback:b().createElement(i.Bullseye,null,b().createElement(i.Spinner,null))},b().createElement(te,null))}}),b().createElement(m.Z,{className:"page-header"},b().createElement(i.Split,{hasGutter:!0,className:"page-title"},b().createElement(i.SplitItem,{isFilled:!0},b().createElement(i.Flex,null,b().createElement(i.FlexItem,{spacer:{default:"spacerSm"}},b().createElement(p.Z,{title:"Remote Host Configuration Manager"})),b().createElement(i.FlexItem,null,b().createElement(ee,null)))),b().createElement(i.SplitItem,null,b().createElement(i.Button,{onClick:function(){return e.push(W.logModal)},variant:"link"},"View log"))),b().createElement(i.Stack,{hasGutter:!0},b().createElement(i.StackItem,null,"Selections here affect Red Hat Enterprise Linux (RHEL) systems connected to Red Hat with remote host configuration (rhc). Upon saving changes, Ansible Playbooks are automatically pushed to connected systems to update the configuration of the connection to Red Hat."),b().createElement(i.StackItem,null,b().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2021/html-single/red_hat_connector_configuration_guide/index"},"Connecting with Red Hat",b().createElement(u.ZP,{className:"pf-u-ml-sm"}))))),b().createElement(i.Page,null,b().createElement("div",{className:"dashboard__content"},w||void 0!==x&&void 0!==D?b().createElement(A,{madeChanges:v,setConfirmChangesOpen:s,setMadeChanges:C,setIsEditing:I,isEditing:_,defaults:{useOpenSCAP:x,enableCloudConnector:D,hasInsights:T},onChange:function(e){k.current=e}}):b().createElement(i.Bullseye,null,b().createElement(i.Spinner,{className:"pf-u-p-lg",size:"xl"})))),b().createElement(P,{isOpen:l,handleCancel:function(){return s(!1)},systemsCount:F,data:k.current,handleConfirm:function(){s(!1),o()(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,N.mt)(k.current),j(t),e.next=4,t.payload;case 4:j((0,d.wN)({variant:"success",title:"Changes saved",description:"Your service enablement changes were applied to connected systems"})),C(!1),I(!1);case 7:case"end":return e.stop()}}),e)})))()}}))}},94962:(e,t,n)=>{n.d(t,{dx:()=>o,TQ:()=>l,ok:()=>s});var a=n(77460),r=n(91571),l=function(){return a.ZP.get("".concat("/api/inventory/v1","/hosts?filter[system_profile][rhc_client_id]=not_nil&fields[system_profile]=rhc_client_id,rhc_config_state&staleness=fresh&staleness=stale&&registered_with=insights"))},o=new r.DefaultApi(void 0,"/api/config-manager/v1",a.ZP),s=function(e){var t=e.useOpenSCAP,n=e.enableCloudConnector,a=e.hasInsights;return o.updateStates({compliance_openscap:t?"enabled":"disabled",insights:t||n||a?"enabled":"disabled",remediations:n?"enabled":"disabled"})}},49120:(e,t,n)=>{n.d(t,{K8:()=>a,If:()=>r,tj:()=>l,o9:()=>o});var a="GET_CURR_STATE",r="SET_CURR_STATE",l="GET_LOG",o="GET_CONNECTED_HOSTS"},94778:(e,t,n)=>{n.d(t,{Qe:()=>l,mt:()=>o,VU:()=>s,j$:()=>c});var a=n(94962),r=n(49120),l=function(){return{type:r.K8,payload:a.dx.getCurrentState()}},o=function(e){return{type:r.If,payload:(0,a.ok)(e)}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.perPage,n=void 0===t?50:t,l=e.page,o=void 0===l?1:l;return{type:r.tj,payload:a.dx.getStates(n,(o-1)*n)}},c=function(){return{type:r.o9,payload:(0,a.TQ)()}}},1401:(e,t,n)=>{n.d(t,{_:()=>a,S:()=>r});var a=function(e,t,n){return e>1?n||t+"s":t},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"".concat((new Date).toISOString()),n="data:text/plain;charset=utf-8,",a=new Blob([e],{type:n}),r=document.createElement("a");r.setAttribute("href",URL.createObjectURL(a)),r.setAttribute("download","".concat(t,".yml")),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}}]);
//# sourceMappingURL=../sourcemaps/Dashboard.0b94876c8ff47dc95969a60e71b0e170.js.map