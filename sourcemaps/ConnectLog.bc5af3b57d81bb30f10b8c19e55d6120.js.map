{"version":3,"file":"js/ConnectLog.1671723239402.09945876289d1a71022e.js","mappings":"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","sources":["webpack:///./src/Components/ConnectLog/LogNestedtable.js","webpack:///./src/Components/ConnectLog/LogsTable.js","webpack:///./src/Components/ConnectLog/SystemsTable.js","webpack:///./src/Components/ConnectLog/index.js"],"sourcesContent":["import React from 'react';\nimport {\n  Stack,\n  StackItem,\n  TextContent,\n  Text,\n  TextVariants,\n} from '@patternfly/react-core';\nimport PropTypes from 'prop-types';\nimport { Table, TableHeader, TableBody } from '@patternfly/react-table';\n\nconst columns = [\n  { title: 'Service' },\n  {\n    title: 'State',\n  },\n];\n\nconst rowMapper = {\n  compliance: 'Use OpenSCAP for Compliance policies',\n  remediations: 'Enable Cloud Connector to fix issues directly from Insights',\n};\n\nconst LogNestedTable = ({ services, isInsights }) => {\n  return (\n    <Stack>\n      <StackItem>\n        <TextContent>\n          <Text component={TextVariants.h3}>State pushed to systems</Text>\n        </TextContent>\n      </StackItem>\n      <Table\n        aria-label=\"Active services Table\"\n        className=\"sed-c-services__table\"\n        cells={columns}\n        rows={[\n          {\n            noPadding: true,\n            cells: [\n              'Connected to Red Hat Insighsts',\n              isInsights ? 'on' : 'off',\n            ],\n          },\n          ...Object.entries(services).map(([key, value]) => [\n            rowMapper[key],\n            value === 'enabled' ? 'on' : 'off',\n          ]),\n        ]}\n        variant=\"compact\"\n      >\n        <TableHeader />\n        <TableBody />\n      </Table>\n    </Stack>\n  );\n};\n\nLogNestedTable.propTypes = {\n  services: PropTypes.shape({\n    compliance: PropTypes.bool,\n    remediations: PropTypes.bool,\n  }).isRequired,\n  isInsights: PropTypes.bool.isRequired,\n};\n\nexport default LogNestedTable;\n","import React, { Fragment, useEffect, useState, useCallback } from 'react';\nimport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableVariant,\n  expandable,\n  cellWidth,\n} from '@patternfly/react-table';\nimport PropTypes from 'prop-types';\nimport {\n  Pagination,\n  Skeleton,\n  PaginationVariant,\n  Button,\n} from '@patternfly/react-core';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport { fetchLog } from '../../store/actions';\nimport { DateFormat } from '@redhat-cloud-services/frontend-components/DateFormat';\nimport { SkeletonTable } from '@redhat-cloud-services/frontend-components/SkeletonTable';\nimport { TableToolbar } from '@redhat-cloud-services/frontend-components/TableToolbar';\nimport { PrimaryToolbar } from '@redhat-cloud-services/frontend-components/PrimaryToolbar';\nimport flatMap from 'lodash/flatMap';\nimport LogNestedTable from './LogNestedtable';\nimport { downloadFile } from '../../utils/helpers';\nimport { configApi } from '../../api';\n\nconst columns = [\n  {\n    title: 'Initiated date/time',\n    cellFormatters: [expandable],\n  },\n  'Initiator',\n  {\n    title: 'Playbook',\n    transforms: [cellWidth(20)],\n  },\n];\n\nconst rowsMapper = (results, opened) =>\n  flatMap(\n    results.map(\n      (\n        {\n          account_id,\n          created_at: createdAt,\n          id,\n          compliance,\n          remediations,\n          insights,\n        },\n        key\n      ) => [\n        {\n          id,\n          isOpen: opened.includes(id),\n          cells: [\n            <Fragment key=\"date\">\n              <DateFormat\n                date={new Date(createdAt)}\n                extraTitle=\"Created at: \"\n              />\n            </Fragment>,\n            account_id,\n            <Fragment key={`download file-${id}`}>\n              <Button\n                variant=\"link\"\n                isInline\n                onClick={() => {\n                  (async () => {\n                    const data = await configApi.getPlaybook(id);\n                    downloadFile(data);\n                  })();\n                }}\n              >\n                Download\n              </Button>\n            </Fragment>,\n          ],\n        },\n        {\n          parent: key * 2,\n          cells: [\n            <Fragment key=\"nested-table\">\n              <LogNestedTable\n                services={{\n                  compliance,\n                  remediations,\n                }}\n                isInsights={insights}\n              />\n            </Fragment>,\n          ],\n        },\n      ]\n    )\n  );\n\nconst LogsTable = () => {\n  const [opened, setOpened] = useState([]);\n  const dispatch = useDispatch();\n  const logLoaded = useSelector(\n    ({ logReducer }) => logReducer?.loaded || false\n  );\n  const rows = useSelector(({ logReducer }) => logReducer?.results || []);\n  const pagination = useSelector(\n    ({ logReducer }) => ({\n      itemCount: logReducer?.total,\n      perPage: logReducer?.limit,\n      page:\n        Math.floor((logReducer?.offset || 0) / (logReducer?.limit || 0)) + 1,\n    }),\n    shallowEqual\n  );\n  useEffect(() => {\n    dispatch(fetchLog());\n  }, []);\n  const onCollapse = (_e, _key, isOpen, { id }) => {\n    setOpened(() =>\n      isOpen ? [...opened, id] : opened.filter((openId) => openId !== id)\n    );\n  };\n\n  const setPage = useCallback(\n    (_e, pageNumber) =>\n      dispatch(fetchLog({ page: pageNumber, perPage: pagination.perPage })),\n    [dispatch, pagination.perPage]\n  );\n\n  const setPerPage = useCallback(\n    (_e, perPage) => dispatch(fetchLog({ page: 1, perPage })),\n    [dispatch]\n  );\n\n  return (\n    <Fragment>\n      <PrimaryToolbar\n        pagination={\n          logLoaded ? (\n            {\n              ...pagination,\n              onSetPage: setPage,\n              onPerPageSelect: setPerPage,\n            }\n          ) : (\n            <Skeleton width=\"33%\" />\n          )\n        }\n      />\n      {logLoaded ? (\n        <Table\n          aria-label=\"Logs table\"\n          variant={TableVariant.compact}\n          rows={rowsMapper(rows, opened)}\n          cells={columns}\n          onCollapse={onCollapse}\n        >\n          <TableHeader />\n          <TableBody />\n        </Table>\n      ) : (\n        <SkeletonTable colSize={3} rowSize={10} />\n      )}\n      <TableToolbar isFooter>\n        {logLoaded ? (\n          <Pagination\n            {...pagination}\n            variant={PaginationVariant.bottom}\n            onSetPage={setPage}\n            onPerPageSelect={setPerPage}\n          />\n        ) : (\n          <Skeleton width=\"33%\" />\n        )}\n      </TableToolbar>\n    </Fragment>\n  );\n};\n\nLogsTable.propTypes = {\n  isActive: PropTypes.bool,\n};\n\nLogsTable.defaultProps = {\n  isActive: false,\n};\n\nexport default LogsTable;\n","import React from 'react';\nimport { InventoryTable } from '@redhat-cloud-services/frontend-components/Inventory';\nimport { register } from '../../store';\n\nconst SystemsTable = () => {\n  return (\n    <InventoryTable\n      variant=\"compact\"\n      showTags\n      hasCheckbox={false}\n      columns={(defaultColumns) => defaultColumns}\n      getEntities={async (_i, config, tags, defaultGetEntities) => {\n        config.filter = {\n          system_profile: {\n            rhc_client_id: 'not_nil',\n          },\n        };\n        const data = await defaultGetEntities(undefined, config, tags);\n        return data;\n      }}\n      onRowClick={(_e, id) =>\n        (window.location.href = `./insights/inventory/${id}`)\n      }\n      onLoad={({ mergeWithEntities }) => {\n        register?.({\n          ...mergeWithEntities(),\n        });\n      }}\n    />\n  );\n};\n\nexport default SystemsTable;\n","import React, { useEffect, useState } from 'react';\nimport { Modal, Tabs, Tab, TabTitleText } from '@patternfly/react-core';\nimport LogsTable from './LogsTable';\nimport SystemsTable from './SystemsTable';\nimport { useHistory } from 'react-router-dom';\nimport pckg from '../../../package.json';\nimport { useDispatch } from 'react-redux';\nimport { clearNotifications } from '@redhat-cloud-services/frontend-components-notifications/redux';\nconst { routes: paths } = pckg;\n\nconst tabMapper = ['runs', 'systems'];\n\nconst ConnectLog = () => {\n  const [activeTabKey, setActiveTabKey] = useState(0);\n  const dispatch = useDispatch();\n  const { push, location } = useHistory();\n  useEffect(() => {\n    dispatch(clearNotifications());\n    const searchParams = new URLSearchParams(location.search);\n    const activeTab = tabMapper.findIndex(\n      (item) => item === searchParams.get('active_tab')\n    );\n    if (activeTab !== -1) {\n      setActiveTabKey(activeTab);\n    } else {\n      push({\n        pathname: location.pathname,\n        search: new URLSearchParams({\n          active_tab: tabMapper[0],\n        }).toString(),\n      });\n    }\n  }, []);\n  return (\n    <Modal\n      title=\"Red Hat connect log\"\n      variant=\"medium\"\n      isOpen={true}\n      onClose={() => push(paths.connector)}\n    >\n      <Tabs\n        activeKey={activeTabKey}\n        onSelect={(_e, tabKey) => {\n          push({\n            pathname: location.pathname,\n            search: new URLSearchParams({\n              active_tab: tabMapper[tabKey],\n            }).toString(),\n          });\n          setActiveTabKey(tabKey);\n        }}\n      >\n        <Tab eventKey={0} title={<TabTitleText>Runs</TabTitleText>}>\n          <LogsTable />\n        </Tab>\n        <Tab eventKey={1} title={<TabTitleText>Systems</TabTitleText>}>\n          <SystemsTable />\n        </Tab>\n      </Tabs>\n    </Modal>\n  );\n};\n\nexport default ConnectLog;\n"],"names":["columns","title","rowMapper","compliance","remediations","LogNestedTable","services","isInsights","Stack","StackItem","TextContent","Text","component","TextVariants","Table","className","cells","rows","noPadding","Object","entries","map","key","value","variant","TableHeader","TableBody","propTypes","PropTypes","isRequired","i","cellFormatters","expandable","transforms","cellWidth","rowsMapper","results","opened","flatMap","account_id","createdAt","created_at","id","insights","isOpen","includes","Fragment","DateFormat","date","Date","extraTitle","Button","isInline","onClick","configApi","data","downloadFile","parent","LogsTable","useState","setOpened","dispatch","useDispatch","logLoaded","useSelector","logReducer","loaded","pagination","itemCount","total","perPage","limit","page","Math","floor","offset","shallowEqual","useEffect","fetchLog","setPage","useCallback","_e","pageNumber","setPerPage","PrimaryToolbar","onSetPage","onPerPageSelect","Skeleton","width","TableVariant","onCollapse","_key","filter","openId","SkeletonTable","colSize","rowSize","TableToolbar","isFooter","Pagination","PaginationVariant","isActive","defaultProps","InventoryTable","showTags","hasCheckbox","defaultColumns","getEntities","_i","config","tags","defaultGetEntities","system_profile","rhc_client_id","undefined","onRowClick","window","location","href","onLoad","mergeWithEntities","register","paths","pckg","tabMapper","activeTabKey","setActiveTabKey","useHistory","push","clearNotifications","searchParams","URLSearchParams","search","activeTab","findIndex","item","get","pathname","active_tab","toString","Modal","onClose","connector","Tabs","activeKey","onSelect","tabKey","Tab","eventKey","TabTitleText"],"sourceRoot":""}